<!doctype html>
<html lang="en" data-manifest="" data-framework="typescript">

<head>
    <meta charset="utf-8">
    <title></title>
    <link rel="stylesheet" type="text/css" href="/sim/sim.css">
    <style>
        body {
            background: transparent;
            overflow: hidden;
        }
    </style>
    
    <script src="/cdn/bluebird.min.js"></script>
    <script src="/cdn/pxtsim.js"></script>
    <script src="/sim/sim.js"></script>

    <!-- include AFRAME and AR.js -->
    <script src="/sim/aframe.min.js"></script>
    <script src="/sim/aframe-ar.js"></script>
    <script src="/sim/StereoEffect.js"></script>
    <script src="/sim/STLLoader.js"></script>
    <script src="/sim/MTLLoader.js"></script>
    <script src="/sim/ColladaLoader.js"></script>
    <script src="/sim/OBJLoader.js"></script>
    <script src="/sim/tone.min.js"></script>

</head>

<body>
    <button id="flip" onClick="flipSim()" style="position: absolute; z-index: 9999;">flip</button>
    <script>
        var flipCss = "-moz-transform: scaleX(-1); -o-transform: scaleX(-1); " +
                            "-webkit-transform: scaleX(-1); transform: scaleX(-1);";
        var flipFilter = " FlipH ";
        function flipSim (){
            var canvas = document.getElementsByTagName("canvas")[0];
            var video  = document.getElementsByTagName("video")[0];
            var canvasCssText = canvas.getAttribute("style");
            var videoCssText  = video.getAttribute("style");

            if (canvasCssText.includes(flipCss)){
                canvasCssText       = canvasCssText.replace(flipCss, "");
                videoCssText        = videoCssText.replace(flipCss, "");
                canvas.setAttribute("style", canvasCssText);
                video.setAttribute("style", videoCssText);
                canvas.style.filter = canvas.style.filter.replace(flipFilter, "");
                video.style.filter  = video.style.filter.replace(flipFilter, "");
            } else {
                canvasCssText      = canvasCssText + " " + flipCss;
                videoCssText       = videoCssText + " " + flipCss;
                canvas.setAttribute("style", canvasCssText);
                video.setAttribute("style", videoCssText);                
                canvas.style.filter += flipFilter;
                video.style.filter += flipFilter;
            }
        }
    </script>
</body>
